# 🚀 启动说明 - 带登录功能版本

## ✅ 已完成的功能

### 前端登录界面
- ✅ 美观的登录页面
- ✅ 账号：`admin`
- ✅ 密码：`003717`（可在 .env 中修改）

### 权限控制
- ✅ 登录后可使用所有功能
- ✅ 未登录只能查询激活（但需要先登录才能访问页面）
- ✅ Token 自动管理和过期处理

## 🚀 快速开始

### 1. 确保服务正在运行
检查服务是否运行在 8001 端口：
```bash
# 如果已经在运行，可以直接访问
# 如果没有运行，启动服务：
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8001
```

### 2. 访问系统
打开浏览器访问：
```
http://localhost:8001
```

### 3. 登录系统
- 账号：`admin`
- 密码：`003717`

### 4. 开始使用
登录后即可使用所有功能！

## 📸 功能展示

### 登录页面
- 渐变背景设计
- 清晰的登录表单
- 功能提示信息

### 主应用界面
- 侧边栏显示登录状态
- 显示当前登录用户（admin）
- "退出登录"按钮

### 功能权限
✅ **登录后可用：**
- 概览页面
- 卡片列表
- 卡片详情
- 消费记录查询
- 批量导入
- 卡片编辑/删除
- 退款管理
- 使用标记
- 所有管理功能

✅ **无需登录（API层面）：**
- 查询激活
- 批量激活
> 注：虽然API不需要登录，但前端页面需要登录才能访问

## 🔐 登录信息

### 默认账号密码
```
账号：admin
密码：003717
```

### 修改密码
在项目根目录创建或修改 `.env` 文件：
```env
AUTH_PASSWORD=your_new_password
```

## 🧪 测试功能

### 测试 1：登录
1. 访问 http://localhost:8001
2. 应该看到登录页面
3. 输入 `admin` / `003717`
4. 点击登录
5. ✅ 进入主应用界面

### 测试 2：查看登录状态
1. 登录后查看左侧边栏底部
2. ✅ 应该显示"admin"和"已登录"标签
3. ✅ 应该有"退出登录"按钮

### 测试 3：使用功能
1. 点击"卡片列表"
2. ✅ 应该能正常加载和显示
3. 点击"批量导入"
4. ✅ 应该能正常使用

### 测试 4：退出登录
1. 点击"退出登录"按钮
2. 确认退出
3. ✅ 应该返回登录页面

### 测试 5：刷新保持登录
1. 登录后刷新页面（F5）
2. ✅ 应该保持登录状态
3. ✅ 不会回到登录页

## 🔧 故障排除

### 问题1：页面空白
**解决方案：**
1. 打开浏览器控制台（F12）
2. 检查是否有JavaScript错误
3. 清除浏览器缓存后重试

### 问题2：登录失败
**解决方案：**
1. 检查账号密码是否正确
2. 查看浏览器控制台的错误信息
3. 检查后端服务是否正常运行

### 问题3：登录后立即退出
**解决方案：**
1. 检查浏览器是否支持 localStorage
2. 清除浏览器所有 localhost 的数据
3. 重新登录

### 问题4：提示Token过期
**解决方案：**
1. 这是正常的（默认24小时过期）
2. 重新登录即可
3. 可以在 .env 中修改过期时间：
```env
AUTH_TOKEN_EXPIRE_HOURS=48
```

## 📝 技术说明

### 前端实现
- Token 存储在 `localStorage`
- 使用 `fetchWithAuth` 包装所有需要鉴权的请求
- 自动处理 401 错误并重新登录

### 后端实现
- JWT Token 认证
- 账号固定为 `admin`
- 密码可通过环境变量配置
- Token 默认 24 小时有效

## 📚 相关文档

- `前端登录功能说明.md` - 详细的功能说明和技术实现
- `AUTH_SUMMARY.md` - 鉴权功能总结
- `README_AUTH.md` - API 鉴权使用文档

## ✨ 功能特点

### 1. 用户体验
- ✅ 美观的登录界面
- ✅ 平滑的页面切换
- ✅ 清晰的状态提示
- ✅ 自动保持登录

### 2. 安全性
- ✅ JWT Token 认证
- ✅ Token 自动过期
- ✅ 401 自动处理
- ✅ 密码可配置

### 3. 便捷性
- ✅ 默认账号密码
- ✅ 登录状态保持
- ✅ 一键退出登录
- ✅ 功能提示完善

## 🎯 开始使用

1. 确保服务运行在 8001 端口
2. 访问 http://localhost:8001
3. 使用 `admin` / `003717` 登录
4. 开始管理您的卡片！

---

**准备好了吗？现在就开始使用吧！** 🎉
