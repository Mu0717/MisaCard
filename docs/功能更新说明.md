# MisaCard Manager - 功能更新说明

## 📋 更新概述

本次更新为系统添加了两个实用功能，提升了卡密管理的便捷性。

---

## ✨ 新增功能

### 1. 批量复制卡密功能

**功能描述：**
在卡片列表页面，用户可以批量选择多张卡片，一键复制所有选中卡片的卡密（card_id）。

**使用场景：**
- 需要批量导出卡密进行备份
- 需要将卡密批量分享给他人
- 需要批量导入到其他系统

**操作步骤：**
1. 进入"卡片列表"页面
2. 勾选需要复制的卡片（可使用"一键选中已激活未使用"快速选择）
3. 点击批量操作栏中的"批量复制卡密"按钮（蓝色）
4. 卡密已复制到剪贴板，每行一个

**界面位置：**
- 卡片列表页面 → 批量操作栏 → "批量复制卡密"按钮

**复制格式：**
```
mio-f3dc27e4-e853-429a-9e4b-3294af7c25ca
mio-7441ca67-058b-4d98-885b-4774bfb7ba86
mio-a1b2c3d4-e5f6-7890-abcd-ef1234567890
```

---

### 2. 根据额度筛选卡片功能

**功能描述：**
在卡片列表页面，用户可以通过额度输入框筛选指定额度的卡片，支持与其他筛选条件组合使用。

**使用场景：**
- 快速筛选特定额度的卡片
- 统计某个额度的卡片数量和状态
- 批量管理相同额度的卡片

**操作步骤：**
1. 进入"卡片列表"页面
2. 在筛选栏找到"筛选额度"输入框
3. 输入要筛选的额度（如：1, 2, 5）
4. 点击"搜索"按钮
5. 查看筛选后的卡片列表

**筛选特性：**
- 支持精确匹配额度值
- 支持小数额度（如 1.5, 2.99）
- 可与状态、退款状态、使用状态等条件组合筛选
- 支持对筛选结果进行批量操作

**界面位置：**
- 卡片列表页面 → 筛选栏 → "筛选额度"输入框

**组合筛选示例：**
- 筛选额度为 $1 且状态为"已激活"的卡片
- 筛选额度为 $2 且未使用的卡片
- 筛选额度为 $5 且未申请退款的卡片

---

## 🔧 技术实现

### 后端 API

**保留接口：**
```
GET /api/cards/query/by-limit?limit={额度值}
```

**说明：**
- 该接口已实现但前端未使用
- 前端采用客户端筛选方式，性能更好
- 接口可供未来扩展或第三方调用使用

**文件修改：**
- `app/api/cards.py` - 保留 `query_cards_by_limit` 函数（备用）

### 前端功能

**新增 JavaScript 函数：**
1. `batchCopyCardIds()` - 批量复制卡密

**修改 JavaScript 函数：**
1. `loadCards()` - 添加额度筛选逻辑

**界面更新：**
1. 卡片列表页面：添加"批量复制卡密"按钮
2. 卡片列表页面：添加"筛选额度"输入框

**文件修改：**
- `app/templates/index.html` - 添加UI和JavaScript功能

---

## 🔐 权限说明

| 功能 | 登录用户 | 访客模式 |
|------|----------|----------|
| 批量复制卡密 | ✅ 可用 | ❌ 不可用 |
| 根据额度筛选 | ✅ 可用 | ❌ 不可用 |

---

## 📊 功能对比

| 功能 | 批量复制 | 批量复制卡密 |
|------|----------|--------------|
| 复制内容 | 卡号\|月份\|年份\|CVC | 仅卡密（card_id） |
| 格式 | 4111...\|12\|2025\|123 | mio-xxx... |
| 要求 | 需已激活 | 无要求 |
| 用途 | 用于支付 | 用于管理/备份 |

---

## 🎯 使用建议

### 批量复制卡密
- ✅ 适合：批量备份、批量分享、批量导入
- ❌ 不适合：直接用于支付（应使用"批量复制"功能）

### 根据额度筛选
- ✅ 适合：筛选特定额度卡片、组合条件筛选、批量管理
- ❌ 不适合：查询单张卡片（应使用搜索功能）
- 💡 提示：可以与其他筛选条件组合使用，功能更强大

---

## 🐛 已知问题

目前没有已知问题。

---

## 📝 更新记录

**版本：v2.1.0**
- 日期：2025-12-08
- 新增批量复制卡密功能
- 新增根据额度筛选功能（集成在卡片列表）
- 优化筛选条件布局
- 支持多条件组合筛选

---

## 💡 未来计划

- [x] 支持根据多个条件组合筛选（额度+状态+退款+使用）✅
- [ ] 支持导出筛选结果为CSV/Excel
- [ ] 支持批量修改相同额度卡片的属性
- [ ] 添加额度统计图表
- [ ] 支持额度范围筛选（如：1-5美元）

---

## 📞 技术支持

如有问题或建议，请联系系统管理员。

